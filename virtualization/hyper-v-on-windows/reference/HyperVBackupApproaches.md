# <a name="hyper-v-backup-approaches"></a>Резервное копирование подходы Hyper-V
Hyper-V позволяет выполнять резервное копирование виртуальных машин, из операционной системы узла, без необходимости запускать пользовательской резервной копии программного обеспечения на виртуальной машине.  Существует несколько подходов, доступные для разработчиков для использования в зависимости от своих потребностей.
## <a name="hyper-v-vss-writer"></a>Записи VSS Hyper-V
Hyper-V реализует записи VSS во всех версиях Windows Server, где поддерживается Hyper-V.  Этот модуль записи VSS позволяет разработчикам использовать существующую инфраструктуру VSS для резервного копирования виртуальных машин.  Тем не менее она предназначена для небольших операций резервного копирования, где всех виртуальных машин на сервере их резервном копировании одновременно.

Чтобы лучше понять этой архитектуры — см. в этой презентации:https://channel9.msdn.com/Events/TechEd/NorthAmerica/2010/VIR322
## <a name="hyper-v-wmi-based-backup"></a>Резервное копирование на основе WMI Hyper-V
Начиная с Windows Server 2016, Hyper-V работы, поддержка резервного копирования с использованием API-интерфейса WMI Hyper-V.  Этот подход по-прежнему использует VSS на виртуальной машине для резервного копирования, но больше не использует VSS в операционной системе узла.  Вместо этого сочетание моменты и отказоустойчивая исправлений (RCT) используются для позволяют разработчикам доступ к сведениям о резервном копировании виртуальных машин эффективным способом.  Этот подход — большую масштабируемость, чем с помощью VSS в узле, но это только доступны в Windows Server 2016 и более поздних версиях.

Чтобы лучше понять этой архитектуры — см. в этой презентации:https://channel9.msdn.com/Events/TechEd/Europe/2014/CDP-B318 

Существует также пример о том, как использовать эти API доступна здесь:https://msconfiggallery.cloudapp.net/packages/xHyper-VBackup
## <a name="methods-for-reading-backups-from-wmi-based-backup"></a>Методы для чтения резервные копии из резервной копии на основе WMI
При создании архивных копий виртуальной машины с помощью WMI Hyper-V, существует три метода для чтения фактических данных из резервной копии.  Каждый имеет свои преимущества и недостатки.
### <a name="wmi-export"></a>Экспорт WMI
Разработчики могут экспортировать резервного копирования данных через интерфейс WMI Hyper-V (как в приведенном выше примере).  Hyper-V будет компиляции изменения в виртуальный жесткий диск и скопируйте файл к указанному местоположению.  Этот метод — это простой в использовании, работает во всех сценариях он удаленного взаимодействия.  Тем не менее виртуального жесткого диска, созданные часто создает большой объем данных для передачи по сети.
### <a name="win32-apis"></a>API-интерфейсы Win32
Разработчики могут использовать SetVirtualDiskInformation, GetVirtualDiskInformation и QueryChangesVirtualDisk API-интерфейсы в API Win32 виртуального жесткого диска установите описанным ниже: https://docs.microsoft.com/en-us/windows/desktop/api/_vhd/ Обратите внимание, что для использования этих API WMI Hyper-V по-прежнему необходимо использовать для создания ссылки Указывает на связанный виртуальных машин.  Затем эти API-интерфейсы Win32 обеспечивают эффективный доступ к данным из резервной копии виртуальной машины.  API-интерфейсы Win32 имеют несколько ограничения:
*   Он доступен только локально
*   Этого не поддерживает чтение данных из общих файлов виртуального жесткого диска
*   Они возвращают данные адреса, к которым указываются относительно внутреннюю структуру виртуального жесткого диска

### <a name="remote-shared-virtual-disk-protocol"></a>Протокол удаленного общего виртуального диска
Наконец если разработчику необходимо эффективного доступа к информации о резервного копирования данных из файла общего виртуального жесткого диска — им потребуется протокол удаленного общего виртуального диска.  Этот протокол приведены в разделе:https://msdn.microsoft.com/en-us/library/dn393384.aspx
