# <a name="hyper-v-backup-approaches"></a>Подходы резервного копирования Hyper-V
Hyper-V позволяет резервного копирования виртуальных машин из операционной системы, устраняя необходимость выполнения настраиваемого резервных копий программного обеспечения в виртуальном компьютере.  Существует несколько способов, доступных для разработчиков для использования в зависимости от своих потребностей.
## <a name="hyper-v-vss-writer"></a>Модуль записи VSS Hyper-V
Hyper-V реализует модуля записи VSS для всех версий Windows Server, где поддерживается Hyper-V.  Этот модуль записи VSS разработчики могут использовать существующую инфраструктуру служба теневого копирования ТОМОВ для резервного копирования виртуальных машин.  Тем не менее он предназначен для операций резервного копирования малом масштабе, где все виртуальные машины на сервере выполняется резервное копирование одновременно.

Чтобы лучше понять Эта архитектура — обращайтесь к презентации:https://channel9.msdn.com/Events/TechEd/NorthAmerica/2010/VIR322
## <a name="hyper-v-wmi-based-backup"></a>Резервное копирование на основе Hyper-V WMI
Начиная с Windows Server 2016, Hyper-V работы, поддерживающие резервного копирования с использованием интерфейса API WMI Hyper-V.  Такой подход по-прежнему используется служба теневого копирования ТОМОВ в виртуальном компьютере резервного копирования, но более не используется служба теневого копирования ТОМОВ в операционной системы.  Вместо этого сочетание моменты и устойчивое исправлений (RCT) используется для разрешения разработчики могут применить для доступа к сведениям о резервные копии виртуальных машин эффективно.  Такой подход большую масштабируемость, чем использование служба теневого копирования ТОМОВ в узле, но только на Windows Server 2016 и более поздних версий.

Чтобы лучше понять Эта архитектура — обращайтесь к презентации:https://channel9.msdn.com/Events/TechEd/Europe/2014/CDP-B318 

Имеется также пример использования эти интерфейсы API, доступные здесь:https://msconfiggallery.cloudapp.net/packages/xHyper-VBackup
## <a name="methods-for-reading-backups-from-wmi-based-backup"></a>Методы для чтения из резервной копии на основе WMI резервных копий
При создании резервных копий виртуальной машины с помощью Hyper-V WMI, существует три способа для чтения фактические данные из резервной копии.  Каждая имеет свои преимущества и недостатки.
### <a name="wmi-export"></a>Экспорт WMI
Разработчики можно экспортировать резервного копирования данных через интерфейсы Инструментария Hyper-V (как в приведенном выше примере).  Hyper-V будет компилировать изменений в виртуального жесткого диска и скопируйте файл в указанной папке.  Этот метод удобен в использовании, работает для всех сценариев и поддерживающий удаленное взаимодействие.  Тем не менее виртуального жесткого диска, созданный часто создает большой объем данных для передачи по сети.
### <a name="win32-apis"></a>API-интерфейсы Win32
Разработчики могут использовать SetVirtualDiskInformation, GetVirtualDiskInformation и интерфейсы API QueryChangesVirtualDisk на виртуальный жесткий диск Win32 API задания в документации здесь: https://docs.microsoft.com/en-us/windows/desktop/api/_vhd/ Обратите внимание, что для использования этих API WMI Hyper-V по-прежнему должен быть использован для создания ссылки Указывает на связанный виртуальных машин.  Эти интерфейсы API Win32 Подождите, пока для эффективного доступа к данным из резервной копии виртуальной машины.  API-интерфейсы Win32 имеют ряд ограничений:
*   Они осуществляется только локально
*   Действие не поддерживает чтение данных из общих файлов виртуального жесткого диска
*   Они возвращают данные адреса, которые относятся к внутренней структуры виртуальный жесткий диск

### <a name="remote-shared-virtual-disk-protocol"></a>Протокол удаленного общего виртуального диска
И, наконец Если разработчик должен для эффективного доступа к сведениям резервного копирования данных из файла общих виртуальный жесткий диск — они потребуется использовать общую виртуальный диск протокола удаленного.  Этот протокол здесь описаны:https://msdn.microsoft.com/en-us/library/dn393384.aspx
