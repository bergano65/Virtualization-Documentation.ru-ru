---
title: Сетевые подключения контейнеров Windows
description: Сетевая изоляция и безопасность в контейнерах Windows.
keywords: docker, контейнеры
author: jmesser81
ms.date: 03/27/2018
ms.topic: article
ms.prod: windows-containers
ms.service: windows-containers
ms.assetid: 538871ba-d02e-47d3-a3bf-25cda4a40965
ms.openlocfilehash: b39ec17ac04995e8e1ce8795b5721df7a291e31c
ms.sourcegitcommit: 1ca9d7562a877c47f227f1a8e6583cb024909749
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "74910594"
---
# <a name="network-isolation-and-security"></a>Сетевая изоляция и безопасность

## <a name="isolation-with-network-namespaces"></a>Изоляция с помощью сетевых пространств имен

Каждый контейнер размещается в собственном __пространстве имен сети__. Виртуальная сетевая карта узла управления и сетевой стек узла размещаются в пространстве имен сети по умолчанию. Чтобы обеспечить сетевую изоляцию между контейнерами на одном узле, для каждого контейнера Windows Server создается сетевое пространство имен, а контейнеры работают под изоляцией Hyper-V, в которой установлен сетевой адаптер для контейнера. Для подключения к виртуальному коммутатору контейнеры Windows Server используют виртуальный сетевой адаптер узла. Изоляция Hyper-V использует искусственный сетевой адаптер виртуальной машины (не предоставляется для виртуальной машины служебной программы) для подключения к виртуальному коммутатору.

![текст](media/network-compartment-visual.png)

```powershell
Get-NetCompartment
```

## <a name="network-security"></a>Сетевая безопасность

В зависимости от используемого контейнера и сетевого драйвера, списки управления доступом портов применяются с помощью сочетания брандмауэра Windows и [VFP](https://www.microsoft.com/research/project/azure-virtual-filtering-platform/).

### <a name="windows-server-containers"></a>Контейнеры Windows Server

Эти контейнеры используют брандмауэр узла Windows (использующий пространства имен сети) и VFP

* Исходящий трафик по умолчанию: ПОЛНОСТЬЮ РАЗРЕШИТЬ
* Входящий трафик по умолчанию: ПОЛНОСТЬЮ РАЗРЕШИТЬ (TCP, UDP, ICMP, IGMP) незапрошенный сетевой трафик
  * ПОЛНОСТЬЮ ЗАПРЕТИТЬ другой сетевой трафик, поступающий через прочие протоколы

  >[!NOTE]
  >До появления обновления Windows Server версии 1709 и Windows 10 не попадают в обновление, правило для входящего трафика по умолчанию было ОТКЛОНЕНо. Пользователи, выполняющие эти старые выпуски, могут создавать правила входящего трафика с ``docker run -p`` (пересылка портов).

### <a name="hyper-v-isolation"></a>Изоляция Hyper-V

Контейнеры, работающие в изоляции Hyper-V, имеют собственный изолированный ядро и поэтому запускают свой собственный экземпляр брандмауэра Windows со следующей конфигурацией:

* Правило по умолчанию "ПОЛНОСТЬЮ РАЗРЕШИТЬ" в брандмауэре Windows (запущенном в служебной виртуальной машине) и VFP

![текст](media/windows-firewall-containers.png)

### <a name="kubernetes-pods"></a>Модули Kubernetes

В [Kubernetes Pod](https://kubernetes.io/docs/concepts/workloads/pods/pod/)сначала создается контейнер инфраструктуры, к которому присоединена конечная точка. Контейнеры, принадлежащие к одному и тому же модулю, включая контейнеры инфраструктуры и рабочих ролей, совместно используют общее пространство имен сети (то же самое пространство IP-адресов и портов).

![текст](media/pod-network-compartment.png)

### <a name="customizing-default-port-acls"></a>Настройка списков управления доступом портов по умолчанию

Если вы хотите изменить списки ACL портов по умолчанию, сначала прочтите документацию по сетевой службе размещения (ссылка будет добавлена в ближайшее время). Необходимо обновить политики в следующих компонентах:

>[!NOTE]
>Для изоляции Hyper-V в режиме прозрачности и преобразования сетевых адресов (NAT) сейчас невозможно перепрограммировать списки ACL портов по умолчанию. В таблице это отражено пометкой "X".

| Сетевой драйвер | Контейнеры Windows Server | Изоляция Hyper-V  |
| -------------- |-------------------------- | ------------------- |
| Прозрачный режим | Брандмауэр Windows | X |
| NAT | Брандмауэр Windows | X |
| L2Bridge | Устройства обоих типов | VFP |
| L2Tunnel | Устройства обоих типов | VFP |
| Наложение  | Устройства обоих типов | VFP |