---
title: Сетевые подключения контейнеров Windows
description: Сетевая изоляция и безопасность в контейнерах Windows.
keywords: docker, контейнеры
author: jmesser81
ms.date: 03/27/2018
ms.topic: article
ms.prod: windows-containers
ms.service: windows-containers
ms.assetid: 538871ba-d02e-47d3-a3bf-25cda4a40965
ms.openlocfilehash: 7203989483cb07423b70ff8cc644f715ba4be274
ms.sourcegitcommit: ec186664e76d413d3bf75f2056d5acb556f4205d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2018
ms.locfileid: "1876143"
---
# <a name="network-isolation-and-security"></a>Сетевая изоляция и безопасность

## <a name="isolation-with-network-namespaces"></a>Изоляция с использованием пространств имен сети
Каждый контейнер размещается в собственном __пространстве имен сети__. Виртуальная сетевая карта узла управления и сетевой стек узла размещаются в пространстве имен сети по умолчанию. Чтобы обеспечить изоляцию сети между контейнерами на одном узле, для каждого контейнера Windows Server и Hyper-V создается пространство имен сети, куда устанавливается сетевой адаптер этого контейнера. Для подключения к виртуальному коммутатору контейнеры Windows Server используют виртуальный сетевой адаптер узла. Для подключения к виртуальному коммутатору контейнеры Hyper-V используют сетевой адаптер синтетической виртуальной машины (не предоставляется служебной виртуальной машине).


![текст](media/network-compartment-visual.png)


```powershell 
Get-NetCompartment
```

## <a name="network-security"></a>Сетевая безопасность
В зависимости от используемого контейнера и сетевого драйвера, списки управления доступом портов применяются с помощью сочетания брандмауэра Windows и [VFP](https://www.microsoft.com/en-us/research/project/azure-virtual-filtering-platform/).

### <a name="windows-server-containers"></a>Контейнеры Windows Server
Эти контейнеры используют брандмауэр узла Windows (использующий пространства имен сети) и VFP
  * Исходящий трафик по умолчанию: ПОЛНОСТЬЮ РАЗРЕШИТЬ
  * Входящий трафик по умолчанию: ПОЛНОСТЬЮ РАЗРЕШИТЬ (TCP, UDP, ICMP, IGMP) незапрошенный сетевой трафик
    * ПОЛНОСТЬЮ ЗАПРЕТИТЬ другой сетевой трафик, поступающий через прочие протоколы

  > Примечание. Перед выпуском Windows Server версии 1709 и Windows 10 Fall Creators Update правило по умолчанию для входящего *трафика* было "ПОЛНОСТЬЮ ЗАПРЕТИТЬ". Пользователи, использующие такие более старые версии, могут создавать РАЗРЕШАЮЩИЕ правила для входящего трафика с помощью ``docker run -p`` (перенаправление портов)


### <a name="hyper-v-containers"></a>Контейнеры Hyper-V
У контейнеров Hyper-V есть собственное изолированное ядро, поэтому они запускают собственный экземпляр брандмауэра Windows со следующей конфигурацией:
  * Правило по умолчанию "ПОЛНОСТЬЮ РАЗРЕШИТЬ" в брандмауэре Windows (запущенном в служебной виртуальной машине) и VFP


![текст](media/windows-firewall-containers.png)


### <a name="kubernetes-pods"></a>Модули Kubernetes
В [модулях Kubernetes](https://kubernetes.io/docs/concepts/workloads/pods/pod/) сначала создается контейнер инфраструктуры, к которому подключается конечная точка. Контейнеры (в том числе контейнеры инфраструктуры и рабочие контейнеры), относящиеся к одному модулю, делят общее пространство имен сети (одно и то же пространство IP-адресов и портов).


![текст](media/pod-network-compartment.png)


### <a name="customizing-default-port-acls"></a>Настройка списков управления доступом портов по умолчанию
Инструкции по изменению списков управления доступом портов по умолчанию см. в нашей документации по службе HNS (ссылка будет добавлена в ближайшее время). Потребуется обновить политики в следующих компонентах:

> ПРИМЕЧАНИЕ. На данный момент невозможно перепрограммировать списки управления доступом портов по умолчанию для контейнеров Hyper-V в прозрачном режиме и режиме NAT. В таблице это отражено пометкой "X".

| Сетевой драйвер | Контейнеры Windows Server | Контейнеры Hyper-V  |
| -------------- |-------------------------- | ------------------- |
| Прозрачный режим | Брандмауэр Windows | X |
| NAT | Брандмауэр Windows | X |
| L2Bridge | Оба типа | VFP |
| L2Tunnel | Оба типа | VFP |
| Наложение  | Оба типа | VFP |