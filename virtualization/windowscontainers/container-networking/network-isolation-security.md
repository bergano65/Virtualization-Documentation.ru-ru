---
title: Сетевые подключения контейнеров Windows
description: Сетевая изоляция и безопасность в контейнерах Windows.
keywords: docker, контейнеры
author: jmesser81
ms.date: 03/27/2018
ms.topic: article
ms.prod: windows-containers
ms.service: windows-containers
ms.assetid: 538871ba-d02e-47d3-a3bf-25cda4a40965
ms.openlocfilehash: 77e515e5e73d1d9e32b839c568ff3e4faf961c3c
ms.sourcegitcommit: a5ff22c205149dac4fc05325ef3232089826f1ef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "9380118"
---
# <a name="network-isolation-and-security"></a>Сетевая изоляция и безопасность

## <a name="isolation-with-network-namespaces"></a>Изоляция с использованием пространства имен сети

Каждый контейнер размещается в собственном __пространстве имен сети__. Виртуальная сетевая карта узла управления и сетевой стек узла размещаются в пространстве имен сети по умолчанию. Чтобы обеспечить изоляцию сети между контейнерами на одном узле, для каждого контейнера Windows Server создается пространство имен сети и контейнеры запускать изоляцией Hyper-V, куда устанавливается сетевой адаптер этого контейнера. Для подключения к виртуальному коммутатору контейнеры Windows Server используют виртуальный сетевой адаптер узла. Изоляция Hyper-V использует Синтетической виртуальной Машины (не предоставляется служебной виртуальной машине) для присоединения к виртуальному коммутатору.

![текст](media/network-compartment-visual.png)

```powershell
Get-NetCompartment
```

## <a name="network-security"></a>Сетевая безопасность

В зависимости от используемого контейнера и сетевого драйвера, списки управления доступом портов применяются с помощью сочетания брандмауэра Windows и [VFP](https://www.microsoft.com/en-us/research/project/azure-virtual-filtering-platform/).

### <a name="windows-server-containers"></a>Контейнеры Windows Server

Эти контейнеры используют брандмауэр узла Windows (использующий пространства имен сети) и VFP

* Исходящий трафик по умолчанию: ПОЛНОСТЬЮ РАЗРЕШИТЬ
* Входящий трафик по умолчанию: ПОЛНОСТЬЮ РАЗРЕШИТЬ (TCP, UDP, ICMP, IGMP) незапрошенный сетевой трафик
  * ПОЛНОСТЬЮ ЗАПРЕТИТЬ другой сетевой трафик, поступающий через прочие протоколы

  >[!NOTE]
  >До выхода Windows Server версии 1709 и Windows 10 Fall Creators Update входящего трафика правило по умолчанию была полностью запретить. Пользователи, использующие предыдущие выпуски могут создавать разрешающие правила с помощью ``docker run -p`` (перенаправление портов).

### <a name="hyper-v-isolation"></a>Изоляция Hyper-V

Контейнерами в изоляции Hyper-V есть собственное изолированное ядро и поэтому выполните собственный экземпляр брандмауэра Windows со следующими параметрами:

* Правило по умолчанию "ПОЛНОСТЬЮ РАЗРЕШИТЬ" в брандмауэре Windows (запущенном в служебной виртуальной машине) и VFP

![текст](media/windows-firewall-containers.png)

### <a name="kubernetes-pods"></a>Модули Kubernetes

В [Kubernetes pod](https://kubernetes.io/docs/concepts/workloads/pods/pod/)к которому подключается конечная точка сначала создается контейнер инфраструктуры. Контейнеры, которые относятся к одному модулю, инфраструктуры и рабочие контейнеры, в том числе совместно использовать общее пространство имен сети (же IP-адрес и порт места).

![текст](media/pod-network-compartment.png)

### <a name="customizing-default-port-acls"></a>Настройка списков управления доступом портов по умолчанию

Если вы хотите изменить порт по умолчанию списки управления доступом, сначала считать нашей документации сетевой службы узлов (ссылка на добавляться в ближайшее время). Вам потребуется обновить политики в следующих компонентах:

>[!NOTE]
>Для изоляции Hyper-V в прозрачном режиме и NAT режиме в данный момент невозможно перепрограммировать списки управления доступом портов по умолчанию. В таблице это отражено пометкой "X".

| Сетевой драйвер | Контейнеры Windows Server | Изоляция Hyper-V  |
| -------------- |-------------------------- | ------------------- |
| Прозрачный режим | Брандмауэр Windows | X |
| NAT | Брандмауэр Windows | X |
| L2Bridge | Оба типа | VFP |
| L2Tunnel | Оба типа | VFP |
| Наложение  | Оба типа | VFP |