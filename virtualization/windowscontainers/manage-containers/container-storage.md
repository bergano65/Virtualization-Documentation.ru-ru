---
title: Общие сведения о хранилище контейнера
description: Методы использования узла и других типов хранилища контейнерами Windows Server
keywords: контейнеры, том, хранилище, подключение, подключение с привязкой
author: cwilhit
ms.openlocfilehash: fba08de884d59cc1b656895ec2b7078ba3975269
ms.sourcegitcommit: 1ca9d7562a877c47f227f1a8e6583cb024909749
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "74910274"
---
# <a name="container-storage-overview"></a>Общие сведения о хранилище контейнера

<!-- Great diagram would be great! -->

В этом разделе приводятся общие сведения о различных способах, которыми контейнеры используют хранилище в Windows. Контейнеры ведут себя иначе, чем виртуальные машины, когда дело доходит до хранилища. По сути, контейнеры создаются так, чтобы приложение, выполняющееся в них, не выполняло запись состояния в файловой системе узла. По умолчанию контейнеры используют место для временных файлов, но Windows также предоставляет средства для сохранения хранилища.

## <a name="scratch-space"></a>Область временных файлов

Контейнеры Windows по умолчанию используют временные хранилища. Все операции ввода-вывода контейнера выполняются в «вспомогательном пространстве», и каждый контейнер получает свои собственные рабочие области. Создание файлов и запись файлов записываются во вспомогательное пространство и не отправляются на узел. При остановке экземпляра контейнера отбрасывается все изменения, произошедшие во вспомогательном пространстве. При запуске нового экземпляра контейнера для экземпляра предоставляется новое пространство.

## <a name="layer-storage"></a>Хранилище уровня

Как описано в разделе [Общие сведения о контейнерах](../about/index.md), образы контейнеров представляют собой набор файлов, выраженный в виде набора слоев. Хранилищем слоев являются все файлы, встроенные в контейнер. При каждом выполнении операции `docker pull` и `docker run` с контейнером результаты совпадают.

### <a name="where-layers-are-stored-and-how-to-change-it"></a>Где хранятся уровни и как их изменить

При установке по умолчанию уровни хранятся в `C:\ProgramData\docker` и распределяются между каталогами «image» и «windowsfilter». Вы можете изменить место хранения уровней, используя конфигурацию `docker-root`, как показано в документации [по подсистеме Docker в Windows](../manage-docker/configure-docker-daemon.md).

> [!NOTE]
> Для хранилища уровня поддерживается только файловая система NTFS. ReFS не поддерживается.

Вам не следует менять какие-либо файлы в каталогах уровня — они тщательно контролируются с помощью таких команд, как:

- [docker images](https://docs.docker.com/engine/reference/commandline/images/)
- [docker rmi](https://docs.docker.com/engine/reference/commandline/rmi/)
- [docker pull](https://docs.docker.com/engine/reference/commandline/pull/)
- [Загрузка DOCKER](https://docs.docker.com/engine/reference/commandline/load/)
- [docker save](https://docs.docker.com/engine/reference/commandline/save/)

### <a name="supported-operations-in-layer-storage"></a>Поддерживаемые операции хранилища уровня

Запущенные контейнеры могут использовать большинство операций NTFS, за исключением транзакций. К ним относятся настройка списков управления доступом, при этом все списки проверяются внутри контейнера. Если вы хотите запускать процессы как множество пользователей в контейнере, вы можете создать пользователей в `Dockerfile` с помощью `RUN net user /create ...`, настроить списки управления доступом к файлу, а затем настроить процессы для выполнения с этим пользователем с помощью [директивы Dockerfile USER](https://docs.docker.com/engine/reference/builder/#user).

## <a name="persistent-storage"></a>Постоянное хранилище

Контейнеры Windows поддерживают механизмы для обеспечения постоянного хранения с помощью привязок и томов BIND. Дополнительные сведения см. в разделе [постоянное хранилище в контейнерах](./persistent-storage.md).

## <a name="storage-limits"></a>Ограничения хранилища

Обычно приложения для Windows запрашивают объем свободного места на диске перед установкой или созданием новых файлов, а также для удаления временных файлов.  С целью максимизации совместимости приложений диск C: в контейнере Windows представляет виртуальный свободный размер 20 ГБ.

Некоторым пользователям может потребоваться переопределить это значение по умолчанию и настроить свободное пространство для меньшего или большего размера. Это можно сделать с помощью параметра "size" в конфигурации "обязательное хранилище".

### <a name="examples"></a>Примеры

Командная строка: `docker run --storage-opt "size=50GB" mcr.microsoft.com/windows/servercore:ltsc2019 cmd`

Вы также можете изменить файл конфигурации DOCKER напрямую:

```Docker Configuration File
"storage-opts": [
    "size=50GB"
  ]
```

> [!TIP]
> Этот метод также работает для сборки DOCKER. В документе [Настройка docker](https://docs.microsoft.com/virtualization/windowscontainers/manage-docker/configure-docker-daemon#configure-docker-with-configuration-file) представлены дополнительные сведения об изменении файла конфигурации docker.
