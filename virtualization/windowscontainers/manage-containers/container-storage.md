---
title: Общие сведения о хранилище контейнеров
description: Методы использования узла и других типов хранилища контейнерами Windows Server
keywords: контейнеры, том, хранилище, подключение, подключение с привязкой
author: cwilhit
ms.openlocfilehash: fba08de884d59cc1b656895ec2b7078ba3975269
ms.sourcegitcommit: 22dcc1400dff44fb85591adf0fc443360ea92856
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2019
ms.locfileid: "10209754"
---
# <a name="container-storage-overview"></a>Общие сведения о хранилище контейнеров

<!-- Great diagram would be great! -->

В этом разделе приводятся общие сведения о различных способах использования хранилища контейнерами в Windows. Контейнеры ведут себя иначе, чем виртуальные машины, когда они поступают в хранилище. По сути, контейнеры строятся так, чтобы не допустить от записи состояния приложения на компьютере, но и в файловой системе узла. Контейнеры по умолчанию используют пространство "рабочее место", но Windows также предоставляет средства для сохранения хранилища.

## <a name="scratch-space"></a>Рабочая область

Контейнеры Windows по умолчанию используют эфемерное хранилище. Все входные данные находятся в контейнере "Рабочая область", и каждый контейнер получает собственный рабочий процесс. Создание файлов и запись файлов записываются в рабочую область и не переводятся на узел. При остановке экземпляра контейнера все изменения, произошедшие в рабочей области, отменяются. При запуске нового экземпляра контейнера для него предоставляется новое рабочее пространство.

## <a name="layer-storage"></a>Хранилище уровня

Как описано в [обзоре контейнеров](../about/index.md), изображения-контейнеры представляют собой наборы файлов, выраженные в виде серии слоев. Хранилище слоев — это все файлы, которые встроены в контейнер. При каждом выполнении операции `docker pull` и `docker run` с контейнером результаты совпадают.

### <a name="where-layers-are-stored-and-how-to-change-it"></a>Где хранятся уровни и как их изменить

При установке по умолчанию уровни хранятся в `C:\ProgramData\docker` и распределяются между каталогами «image» и «windowsfilter». Вы можете изменить место хранения уровней, используя конфигурацию `docker-root`, как показано в документации [по подсистеме Docker в Windows](../manage-docker/configure-docker-daemon.md).

> [!NOTE]
> Для хранилища уровня поддерживается только файловая система NTFS. ReFS не поддерживается.

Вам не следует менять какие-либо файлы в каталогах уровня— они тщательно контролируются с помощью таких команд, как:

- [docker images;](https://docs.docker.com/engine/reference/commandline/images/)
- [docker rmi;](https://docs.docker.com/engine/reference/commandline/rmi/)
- [docker pull;](https://docs.docker.com/engine/reference/commandline/pull/)
- [docker load;](https://docs.docker.com/engine/reference/commandline/load/)
- [docker save.](https://docs.docker.com/engine/reference/commandline/save/)

### <a name="supported-operations-in-layer-storage"></a>Поддерживаемые операции хранилища уровня

Запущенные контейнеры могут использовать большинство операций NTFS, за исключением транзакций. К ним относятся настройка списков управления доступом, при этом все списки проверяются внутри контейнера. Если вы хотите запускать процессы как множество пользователей в контейнере, вы можете создать пользователей в `Dockerfile` с помощью `RUN net user /create ...`, настроить списки управления доступом к файлу, а затем настроить процессы для выполнения с этим пользователем с помощью [директивы Dockerfile USER](https://docs.docker.com/engine/reference/builder/#user).

## <a name="persistent-storage"></a>Постоянное хранилище

Контейнеры Windows поддерживают механизмы, обеспечивающие постоянное хранение с помощью присоединения и томов BIND. Дополнительные сведения можно найти [в разделе постоянное хранилище в контейнерах](./persistent-storage.md).

## <a name="storage-limits"></a>Ограничения хранилища

Обычно приложения для Windows запрашивают объем свободного места на диске перед установкой или созданием новых файлов, а также для удаления временных файлов.  Благодаря максимально возможной совместимости приложений, диск C: в контейнере Windows представляет виртуальный свободный размер 20 ГБ.

Некоторым пользователям может потребоваться переопределить это значение по умолчанию и настроить свободное место на меньший или более крупный. Это можно сделать с помощью параметра "размер" в конфигурации "необязательное хранилище".

### <a name="examples"></a>Примеры

Командная строка: `docker run --storage-opt "size=50GB" mcr.microsoft.com/windows/servercore:ltsc2019 cmd`

Кроме того, вы можете изменить файл конфигурации Dock напрямую:

```Docker Configuration File
"storage-opts": [
    "size=50GB"
  ]
```

> [!TIP]
> Этот метод также подходит для сборки Dock. В документе [Настройка docker](https://docs.microsoft.com/virtualization/windowscontainers/manage-docker/configure-docker-daemon#configure-docker-with-configuration-file) представлены дополнительные сведения об изменении файла конфигурации docker.
