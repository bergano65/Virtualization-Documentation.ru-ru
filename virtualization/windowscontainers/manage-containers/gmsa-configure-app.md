---
title: Настройка приложения для использования групповой управляемой учетной записи службы
description: Настройка приложений для использования групповой управляемой учетной записи служб (Гмсас) для контейнеров Windows.
keywords: Dock, Containers, Active Directory, гмса, приложения, приложения, групповая управляемая учетная запись службы, групповая управляемая учетные записи служб, конфигурация
author: rpsqrd
ms.date: 09/10/2019
ms.topic: article
ms.prod: windows-containers
ms.service: windows-containers
ms.assetid: 9e06ad3a-0783-476b-b85c-faff7234809c
ms.openlocfilehash: 6635381d5f7ddbebf7bdea4624af241b9f6a6864
ms.sourcegitcommit: 22dcc1400dff44fb85591adf0fc443360ea92856
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2019
ms.locfileid: "10209874"
---
# <a name="configure-your-app-to-use-a-gmsa"></a>Настройка приложения для использования Гмса

В типичной конфигурации контейнер задается только для одной групповой управляемой учетной записи службы (Гмса), которая используется каждый раз при попытке авторизации учетной записи компьютера-контейнера для проверки подлинности сетевых ресурсов. Это означает, что ваше приложение должно работать как **Локальная система** или **Сетевая служба** , если требуется использовать удостоверение гмса.

## <a name="run-an-iis-app-pool-as-network-service"></a>Запуск пула приложений IIS как сетевой службы

Если вы размещаете веб-сайт IIS в вашем контейнере, все, что нужно сделать, чтобы использовать Гмса, — это настроить удостоверение пула приложений на **сетевую службу**. Это можно сделать в Доккерфиле, добавив следующую команду:

```dockerfile
RUN %windir%\system32\inetsrv\appcmd.exe set AppPool DefaultAppPool -processModel.identityType:NetworkService
```

Если ранее вы использовали статические учетные данные пользователя для пула приложений IIS, рассматривайте Гмса как замену для этих учетных данных. Вы можете изменить Гмса между приложениями, тестами и производственными средами, а IIS автоматически берет текущее удостоверение, не изменяя изображение контейнера.

## <a name="run-a-windows-service-as-network-service"></a>Запуск службы Windows в качестве сетевой службы

Если приложение-контейнер выполняется как служба Windows, вы можете настроить службу для работы в качестве **сетевой службы** в доккерфиле:

```dockerfile
RUN sc.exe config "YourServiceName" obj= "NT AUTHORITY\NETWORK SERVICE" password= ""
```

## <a name="run-arbitrary-console-apps-as-network-service"></a>Запуск произвольного консольного приложения в качестве сетевой службы

Для универсальных консольных приложений, не размещенных в службах IIS или Service Manager, зачастую проще запускать контейнер как **сетевую службу** , чтобы приложение автоматически наследовало контекст гмса. Эта функция доступна в Windows Server версии 1709.

Добавьте следующую строку в Доккерфиле, чтобы она выполнялась как сетевая служба по умолчанию:

```dockerfile
USER "NT AUTHORITY\NETWORK SERVICE"
```

Вы также можете подключаться к контейнеру как к сетевой службе на основе одной из `docker exec`них. Это особенно полезно, если вы можете устранить проблемы с подключением в работающем контейнере, если контейнер обычно не запускается как сетевая служба.

```powershell
# Opens an interactive PowerShell console in the container (id = 85d) as the Network Service account
docker exec -it --user "NT AUTHORITY\NETWORK SERVICE" 85d powershell
```

## <a name="next-steps"></a>Дальнейшие действия

Помимо настройки приложений вы также можете использовать Гмсас для:

- [Работа с контейнерами](gmsa-run-container.md)
- [Контейнеры для оркестрации](gmsa-orchestrate-containers.md)

Если во время установки возникнут проблемы, ознакомьтесь с нашим [руководством по устранению неполадок для поиска](gmsa-troubleshooting.md) возможных решений.
