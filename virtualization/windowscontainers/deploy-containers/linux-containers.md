---
title: Контейнеры Linux в Windows
description: Узнайте о различных способах использования Hyper-V для запуска контейнеров Linux в Windows, как если бы они были собственными.
keywords: ЛКОВ, контейнеры Linux, Docker, контейнеры
author: scooley
ms.date: 09/17/2019
ms.topic: article
ms.prod: windows-containers
ms.service: windows-containers
ms.assetid: edfd11c8-ee99-42d8-9878-efc126fe1826
ms.openlocfilehash: 14445f3e9d292dbdab28986e772d0c045fca1586
ms.sourcegitcommit: 1ca9d7562a877c47f227f1a8e6583cb024909749
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2019
ms.locfileid: "74910574"
---
# <a name="linux-containers-on-windows"></a>Контейнеры Linux в Windows

Контейнеры Linux составляют огромную долю общей экосистемы контейнеров и являются фундаментальными для разработки и рабочих сред.  Так как контейнеры совместно используют ядро с узлом контейнера, работа с контейнерами Linux напрямую в Windows не является вариантом[*](linux-containers.md#other-options-we-considered).  Именно здесь виртуализация поступает в эту картину.

Сейчас существует два способа запуска контейнеров Linux с помощью Docker для Windows и Hyper-V:

- Запускайте контейнеры Linux на полной виртуальной машине Linux. как правило, это уже сегодня.
- Запуск контейнеров Linux с [изоляцией Hyper-V](../manage-containers/hyperv-container.md) (лков) — это новый вариант в DOCKER для Windows.

В этой статье описывается, как работает каждый из этих подходов, приводятся рекомендации по выбору решения и общих ресурсов.

## <a name="linux-containers-in-a-moby-vm"></a>Контейнеры Linux на виртуальной машине значок Кита

Чтобы запустить контейнеры Linux на виртуальной машине Linux, следуйте инструкциям в разделе [руководство по началу работы с DOCKER](https://docs.docker.com/docker-for-windows/).

DOCKER удалось запустить контейнеры Linux на рабочем столе Windows, так как он впервые был выпущен в 2016 (до появления изолированных контейнеров Hyper-V или Linux в Windows) с помощью виртуальной машины на основе [линукскит](https://github.com/linuxkit/linuxkit) , работающей на Hyper-V.

В этой модели клиент DOCKER выполняется на рабочем столе Windows, но вызывает управляющую программу DOCKER на виртуальной машине Linux.

![Значок Кита виртуальная машина в качестве узла контейнера](media/MobyVM.png)

В этой модели все контейнеры Linux совместно используют один узел контейнера на основе Linux и все контейнеры Linux:

* Совместно используйте ядро и виртуальную машину значок Кита, но не с узлом Windows.
* Имеют единообразные свойства хранилища и сети с контейнерами Linux, работающими в Linux (так как они работают на виртуальной машине Linux).

Это также означает, что на узле контейнера Linux (значок Кита VM) должна быть запущена управляющая программа DOCKER и все зависимости управляющей программы DOCKER.

Чтобы узнать, используете ли вы виртуальную машину значок Кита, проверьте диспетчер Hyper-V для виртуальной машины значок Кита с помощью пользовательского интерфейса диспетчера Hyper-V или запустите `Get-VM` в окне PowerShell с повышенными привилегиями.

## <a name="linux-containers-with-hyper-v-isolation"></a>Контейнеры Linux с изоляцией Hyper-V

Чтобы испытать контейнеры Linux в Windows (ЛКОВ), следуйте инструкциям контейнера Linux в [контейнерах Linux в Windows 10](../quick-start/quick-start-windows-10-linux.md).

Контейнеры Linux с изоляцией Hyper-V выполняют каждый контейнер Linux на оптимизированной виртуальной машине Linux с достаточной ОС для запуска контейнеров. В отличие от подхода значок Кита VM, каждый контейнер Linux имеет собственный ядро и собственную песочницу виртуальной машины. Они также управляются DOCKER непосредственно в Windows.

![Контейнеры Linux с изоляцией Hyper-V (ЛКОВ)](media/lcow-approach.png)

Подробное рассмотрение того, как Управление контейнерами отличается от подхода значок Кита VM и ЛКОВ, в управлении контейнерами модели ЛКОВ остается в Windows, а каждое ЛКОВ управление происходит через GRPC и контейнеры.  Это означает, что контейнеры дистрибутив Linux, используемые для ЛКОВ, могут иметь намного меньший объем инвентаризации.  Сейчас мы используем Линукскит для оптимизированных контейнеров дистрибутив, но другие проекты, такие как Ката, создают аналогичную высоконастраиваемую систему Linux дистрибутивов (Clear Linux).

Подробнее о каждом ЛКОВе:

![Архитектура ЛКОВ](media/lcow.png)

Чтобы узнать, выполняется ли ЛКОВ, перейдите по адресу `C:\Program Files\Linux Containers`. Если DOCKER настроен для использования ЛКОВ, здесь будет несколько файлов с минимальными Линукскит дистрибутив, которые выполняются в каждом контейнере, работающем под изоляцией Hyper-V.  Обратите внимание, что оптимизированные компоненты виртуальной машины менее 100 МБ, гораздо меньше, чем образ Линукскит в виртуальной машине значок Кита.

### <a name="work-in-progress"></a>Проблемы и их решение

ЛКОВ находится под активной разработкой. Отслеживать текущий ход выполнения в проекте значок Кита на [GitHub](https://github.com/moby/moby/issues/33850)

#### <a name="bind-mounts"></a>Привязки подключений

Тома с привязкой подключения с использованием `docker run -v ...` хранят файлы в файловой системе Windows NTFS, поэтому для операций POSIX потребуется определенная корректировка. Некоторые операции файловой системы в настоящий момент реализованы частично или не реализованы, что может вызывать проблемы с совместимостью для некоторых приложений.

Эти операции в настоящий момент не работают для томов с привязкой подключения:

* MkNod
* XAttrWalk
* XAttrCreate
* Lock
* Getlock
* Auth
* Flush
* INotify

Ряд операций не были полностью реализованы:

* GetAttr — число Nlink всегда равно 2.
* Open — реализованы только флаги ReadWrite, WriteOnly и ReadOnly.

Все эти приложения нуждаются в сопоставлении томов и не будут запускаться или правильно работать.

* MySQL
* PostgreSQL
* WordPress
* Jenkins
* MariaDB
* RabbitMQ

### <a name="extra-information"></a>Дополнительные сведения

[Блог DOCKER с описанием ЛКОВ](https://blog.docker.com/2017/11/docker-for-windows-17-11/)

[Видео о контейнере Linux](https://sec.ch9.ms/ch9/1e5a/08ff93f2-987e-4f8d-8036-2570dcac1e5a/LinuxContainer.mp4)

[Линукскит ЛКОВ — инструкции по сборке в ядре Plus](https://github.com/linuxkit/lcow)

## <a name="when-to-use-moby-vm-vs-lcow"></a>Когда следует использовать виртуальную машину значок Кита или ЛКОВ

### <a name="when-to-use-moby-vm"></a>Когда следует использовать виртуальную машину значок Кита

Сейчас мы рекомендуем использовать метод виртуальной машины значок Кита для работы контейнеров Linux с людьми, которые:

- Требуется стабильная среда контейнера.  Это Docker для Windows по умолчанию.
- Запускайте контейнеры Windows или Linux, но редко и в то же время.
- Наличие сложных или настраиваемых сетевых требований между контейнерами Linux.
- Не требуется изоляция ядра (изоляция Hyper-V) между контейнерами Linux.

### <a name="when-to-use-lcow"></a>Когда следует использовать ЛКОВ

Сейчас мы рекомендуем ЛКОВ пользователям, которые:

- Хотите протестировать новейшие технологии.
- Одновременное выполнение контейнеров Windows и Linux.
- Требуется изоляция ядра (изоляция Hyper-V) между контейнерами Linux.

## <a name="other-options-we-considered"></a>Другие параметры, которые мы рассматриваем

Когда мы рассмотрели способы запуска контейнеров Linux в Windows, мы считали WSL. В конечном итоге мы выбрали подход на основе виртуализации, чтобы контейнеры Linux в Windows были совместимы с контейнерами Linux в Linux. Использование Hyper-V также делает ЛКОВ более безопасным. Мы можем выполнить повторную оценку в будущем, но пока ЛКОВ продолжит использовать Hyper-V.

Если у вас есть мысли, отправьте отзыв с помощью GitHub или UserVoice.  Мы особо ценим отзывы о конкретном интерфейсе, который вы хотели бы увидеть.
