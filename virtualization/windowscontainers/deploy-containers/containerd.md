---
title: Платформа контейнеров Windows
description: Дополнительные сведения о новых контейнера сборке блоков, доступных в Windows.
keywords: LCOW, контейнеры linux, docker, контейнеры, containerd, cri, runhcs, runc
author: scooley
ms.date: 11/19/2018
ms.topic: article
ms.prod: windows-containers
ms.service: windows-containers
ms.assetid: a0e62b32-0c4c-4dd4-9956-8056e9abd9e5
ms.openlocfilehash: 74e22702aa4be30055b3f4f48c7fac926d793095
ms.sourcegitcommit: 03e9203e9769997d8be3f66dc7935a3e5c0a83e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2019
ms.locfileid: "9621612"
---
# <a name="container-platform-tools-on-windows"></a>Инструменты для платформы контейнера в Windows

Развертывание платформы контейнера Windows! Docker была первая часть пути контейнера, теперь мы создаете другие средства платформы контейнера.

* [containerd/cri](https://github.com/containerd/cri) - новое в Windows Server 2019 или Windows 10 1809.
* [runhcs](https://github.com/Microsoft/hcsshim/tree/master/cmd/runhcs) - аналогом узел контейнера Windows runc.
* [hcs](https://docs.microsoft.com/virtualization/api/) - службы контейнера узлов + удобной оболочками, чтобы сделать его проще в использовании.
  * [hcsshim](https://github.com/microsoft/hcsshim)
  * [DotNet-computevirtualization](https://github.com/microsoft/dotnet-computevirtualization)

В этой статье поговорим о платформе контейнера Windows и Linux, а также каждого инструмента платформы контейнера.

## <a name="windows-and-linux-container-platform"></a>Платформа контейнера Windows и Linux

В средах, Linux, контейнер средств управления, таких как Docker встроены в более тщательный набор средств контейнера: [runc](https://github.com/opencontainers/runc) и [containerd](https://containerd.io/).

![Архитектура docker в Linux](media/docker-on-linux.png)

`runc` Это средство командной строки Linux для создания и запущенные контейнеры согласно [спецификации среды выполнения контейнера OCI](https://github.com/opencontainers/runtime-spec).

`containerd` является управляющей программы, который управляет жизненного цикла контейнера загружать и распаковке образ контейнера для выполнения контейнера и контроля со стороны клиентов.

В Windows мы использовал другой подход.  Когда мы начали работать с Docker для поддержки контейнеров Windows, мы создали непосредственно на HCS (службы контейнера узлов).  [В этой записи блога](https://techcommunity.microsoft.com/t5/Containers/Introducing-the-Host-Compute-Service-HCS/ba-p/382332) информации о том, почему мы создали HCS и почему мы воспользовались этот подход к контейнерам изначально.

![Начальный архитектуры подсистема Docker в Windows](media/hcs.png)

На этом этапе Docker по-прежнему напрямую вызывает HCS. В перспективе, тем не менее, средства управления контейнера, развертывание контейнеров Windows и Windows, узел контейнера может вызвать containerd и runhcs так, как они вызывают containerd и runc в Linux.

## <a name="runhcs"></a>runhcs

`runhcs` — это компонент из `runc`.  Например, `runc`, `runhcs` — клиент командной строки для запуска приложений, упакованных в соответствии с форматом инициативе Open Initiative (Container) и является совместимые реализацией спецификации инициативу Open контейнера.

Функциональные различия между runc и runhcs приведены ниже:

* `runhcs` выполняется в Windows.  Обменивается данными с [HCS](containerd.md#hcs) для создания и управления контейнерами.
* `runhcs` можно выполнить различные типы другой контейнер.

  * Windows и Linux с [изоляцией Hyper-V](../manage-containers/hyperv-container.md)
  * Windows обработать контейнеры (образа контейнера должна соответствовать узлу контейнера)

**Использование:**

``` cmd
runhcs run [ -b bundle ] <container-id>
```

`<container-id>` — Это имя для экземпляра контейнера, который вы начинаете работу. Имя должно быть уникальным в узле контейнера.

Каталога набора (с помощью `-b bundle`) не является обязательным.  
Как и в случае с runc, контейнеры настраиваются с помощью пакетов приложений. Пакет контейнера — это каталог с файлом спецификации OCI контейнера, «config.json».  Значение по умолчанию для «bundle» — это текущий каталог.

Этот файл спецификации OCI, «config.json», должен иметь два поля для правильной работы:

* Путь к пространству контейнера временных файлов
* Путь к каталогу уровня контейнера

Контейнер команды, доступные в runhcs относятся:

* Средства для создания и запуска контейнера
  * **запустите** создает и запускает контейнера
  * **Создание** создать контейнер

* Средства для управления процессы, выполняемые в контейнере.
  * **запустите** выполняет процесс определяется пользователем в созданный контейнер
  * **exec** запускает новый процесс внутри контейнера
  * Пауза **Приостановить** приостанавливает все процессы внутри контейнера
  * **Возобновление работы** возобновляет все процессы, которые ранее были приостановлены
  * **PS** ps Отображает процессы, выполняемые в контейнере

* Средства для управления состояние контейнерной
  * **состояние** выводит состояние контейнера
  * **завершить** отправляет указанного сигнала (по умолчанию: сигнал SIGTERM) для процесса инициализации контейнера
  * **Удаление** удаляет все ресурсы, занятые контейнера, часто используется с отключенные контейнера

**Список**является единственным команда, которая можно рассматривать как несколькими контейнерами.  В нем перечислены контейнеры работы или приостановки работы с runhcs с заданным корнем.

### <a name="hcs"></a>СЛУЖБЫ HCS

У нас есть два оболочки доступен на GitHub для взаимодействия с HCS. Так как HCS C API, программы-оболочки облегчают вызова HCS из верхнего уровня языков.  

* [hcsshim](https://github.com/microsoft/hcsshim) - HCSShim записываются в пути и он является основой для runhcs.
Получить последнюю версию из AppVeyor или выполнять ее сборку самостоятельно.
* [dotnet computevirtualization](https://github.com/microsoft/dotnet-computevirtualization) -dotnet-computevirtualization является оболочкой для HCS C#.

Если вы хотите использовать HCS (напрямую или через программу-оболочку), или вы хотите сделать нет ли ржавчины или/Haskell/InsertYourLanguage оболочки HCS, добавьте комментарий.

Для более подробно рассмотреть HCS презентация [John Stark DockerCon](https://www.youtube.com/watch?v=85nCF5S8Qok).

## <a name="containerdcri"></a>containerd/cri

> [!IMPORTANT]
> CRI поддерживается только в Windows Server 2019 10 1809 и более поздних версиях.  Мы также по-прежнему активно разрабатываем containerd для Windows.
> Разработки и тестирования только.

В спецификации OCI определяется один контейнер, [CRI](https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/cri/runtime/v1alpha2/api.proto) (интерфейс среды выполнения контейнера) описывает контейнеры как workload(s) в изолированной среде общей среде под названием модуля.  Модули может содержать один или несколько рабочих нагрузок контейнера.  Модули позволяют оркестратора контейнеров, такие как Kubernetes и сетки структуры службы обработки сгруппированные рабочих нагрузок, которые должны находиться на одном узле с некоторыми общими ресурсами, например, память и vNETs.

containerd/cri позволяет следующая Матрица совместимости для модулей POD:

| ОС узла | ОС контейнера | Изоляция | Поддержка модуля? |
|:-------------------------------------------------------------------------|:-----------------------------------------------------------------------------|:---------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------|
| <ul><li>Windows Server 2019/1809</ul></li><ul><li>Windows 10 1809</ul></li> | Linux | `hyperv` | Да — поддерживает модули несколькими контейнерами — значение true. |
|  | Windows Server 2019/1809 | `process`* или `hyperv` | Да — поддерживает true модули несколькими контейнерами, если каждый контейнер рабочей нагрузки ОС соответствует служебную программу операционной системы виртуальной Машины. |
|  | Windows Server 2016</br>Windows Server 1709</br>Windows Server 1803 | `hyperv` | Частичный — поддерживает pod песочницы, которые может поддерживать один контейнер изолированной от процессов в служебной виртуальной Машине, если ОС контейнера соответствует служебную программу операционной системы виртуальной Машины. |

Узлы \*Windows 10 поддерживают только изоляции Hyper-V

Ссылки в спецификации CRI:

* [RunPodSandbox](https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/cri/runtime/v1alpha2/api.proto#L24) - спецификации модуля
* [CreateContainer](https://github.com/kubernetes/kubernetes/blob/master/pkg/kubelet/apis/cri/runtime/v1alpha2/api.proto#L47) - спецификации рабочей нагрузки

![Средах контейнера на основе Containerd](media/containerd-platform.png)

Хотя runHCS и containerd можно управлять в любой системе Windows Server 2016 или более поздней версии, поддержка модули (группы контейнеров) требуется критические изменения контейнером средств в Windows.  Поддержка CRI доступны в Windows Server 2019 или Windows 10 1809 и более поздних версиях.
